webpackJsonp([71],{K31e:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("6iV/"),r=o.n(a),i={data:function(){return{buttonName:"获取验证码",isDisabled:!1,time:60,ok:"",imgCodeUrl:"",http:this.$store.state.dialog.http,fullscreenLoading:!1,ruleForm:{phone:"",phoneCode:"",imageCode:"",picture:""},rules:{phone:[{required:!0,message:"请填写手机号",trigger:"blur"},{validator:function(e,t,o){!1===/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(t)?o(new Error("请输入正确的手机号")):o()},trigger:"blur"}],imageCode:[{required:!0,message:"请填写图形验证码",trigger:"blur"},{max:4,message:"长度在4个字符",validator:function(e,t,o){4!=t.length?o(new Error("请输入正确的验证码")):o()},trigger:"blur"}],phoneCode:[{required:!0,message:"请填写验证码",trigger:"blur"},{max:4,message:"长度在4个字符",trigger:"blur"}]},labelPosition:"left"}},methods:{changeCode:function(){var e=this;this.axios.post(this.http+"/interface/pcLogin/pictureCode").then(function(t){console.log(t),e.imgCodeUrl=JSON.parse(t.data.data).code})},getPhoneCode:function(){var e=this;if(this.ruleForm.phone&&11==this.ruleForm.phone.length)if(this.ruleForm.imageCode&&4==this.ruleForm.imageCode.length){var t=this;t.isDisabled=!0,this.axios.post(this.http+"/interface/pcLogin/sendCode",r.a.stringify({phone:this.ruleForm.phone,pictureCode:this.ruleForm.imageCode})).then(function(o){if(console.log(o),200==o.data.code)var a=window.setInterval(function(){t.buttonName=t.time+"秒后重新发送",--t.time,t.time<0&&(t.buttonName="重新发送",t.time=60,t.isDisabled=!1,window.clearInterval(a))},1e3);else t.isDisabled=!1,e.$message(o.data.message)})}else this.$message("请填写图形验证码");else this.$message("请填写手机号码")},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.login()})},login:function(){var e=this;this.fullscreenLoading=!0,this.axios.post(this.http+"/interface/pcLogin/enterpriseLogin",r.a.stringify({phone:this.ruleForm.phone,code:this.ruleForm.phoneCode,pictureCode:this.ruleForm.imageCode})).then(function(t){200==t.data.code?(e.setCookie("distributorCode",JSON.parse(t.data.data).distributorCode,1),e.setCookie("ENTER_ID",JSON.parse(t.data.data).roleCode,1),e.setCookie("LOGIN_PHONE",JSON.parse(t.data.data).loginPhone,1),e.setCookie("STATUS",JSON.parse(t.data.data).role,1),1==JSON.parse(t.data.data).role?(e.setCookie("changeUrl","/myUserCenter/userHome",1),e.$router.openPage("/myUserCenter/userHome",1),e.setCookie("messageUrl","/distributorCenter/message")):2==JSON.parse(t.data.data).role?(e.setCookie("messageUrl","/myUserCenter/message",1),e.setCookie("changeUrl","/distributorCenter/banlance",1),e.$router.openPage("/distributorCenter/banlance")):3==JSON.parse(t.data.data).role&&(e.setCookie("changeUrl","/myCenter/home",1),e.setCookie("messageUrl","/myCenter/message",1),e.$router.openPage("/distributorCenter/banlance")),location.reload()):(e.fullscreenLoading=!1,e.$message("登陆失败:"+t.data.message))})},setCookie:function(e,t,o){var a=new Date;a.setDate(a.getDate()+o),document.cookie=e+"="+escape(t)+(null==o?"":";expires="+a.toGMTString())}},created:function(){console.log(this.$getcookie("STATUS"),"999999999999999")},mounted:function(){this.changeCode()}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"login_style",staticStyle:{"min-width":"1190px",margin:"0px auto",float:"none"}},[o("el-form",{ref:"ruleForm",attrs:{"label-position":e.labelPosition,model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[o("div",{staticClass:"login_box"},[o("h4",[e._v("用户登陆")]),e._v(" "),o("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[o("el-col",{attrs:{span:24}},[o("el-input",{attrs:{type:"text",placeholder:"请输入手机号","auto-complete":"off"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"验证码",prop:"imageCode"}},[o("el-col",{staticStyle:{"margin-top":"0"},attrs:{span:16}},[o("el-input",{attrs:{placeholder:"请输入验证码","auto-complete":"off",clearable:""},model:{value:e.ruleForm.imageCode,callback:function(t){e.$set(e.ruleForm,"imageCode",t)},expression:"ruleForm.imageCode"}})],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("span",{staticClass:"img-validate-code"},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点图片重新获取验证码",placement:"right"}},[o("img",{attrs:{id:"codeimg",src:"data:image/jpg;base64,"+e.imgCodeUrl},on:{click:function(t){e.changeCode()}}})])],1)])],1),e._v(" "),o("el-form-item",{attrs:{label:"手机验证码",prop:"phoneCode"}},[o("el-col",{staticStyle:{"margin-top":"0"},attrs:{span:16}},[o("el-input",{attrs:{placeholder:"请输入手机验证码",clearable:""},model:{value:e.ruleForm.phoneCode,callback:function(t){e.$set(e.ruleForm,"phoneCode",t)},expression:"ruleForm.phoneCode"}})],1),e._v(" "),o("el-col",{staticClass:"get_btn",attrs:{span:7,offset:1}},[o("el-button",{staticStyle:{padding:"12px 0"},attrs:{disabled:e.isDisabled,id:"codeimg"},on:{click:function(t){e.getPhoneCode()}}},[e._v(e._s(e.buttonName))])],1)],1),e._v(" "),o("div",[o("el-button",{attrs:{span:24},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("登录")])],1)],1)])],1)},staticRenderFns:[]};var n=o("vSla")(i,s,!1,function(e){o("rWW6")},"data-v-126dae69",null);t.default=n.exports},rWW6:function(e,t){}});